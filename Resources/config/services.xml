<?xml version="1.0" ?>

<container xmlns="http://symfony.com/schema/dic/services"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://symfony.com/schema/dic/services http://symfony.com/schema/dic/services/services-1.0.xsd">

    <parameters>
        <parameter key="tadcka_sitemap.loader.tree.class">Tadcka\Bundle\SitemapBundle\Tree\TreeLoader</parameter>
        <parameter key="tadcka_sitemap.listener.edit_node.class">Tadcka\Bundle\SitemapBundle\EventListener\EditNodeListener</parameter>
        <parameter key="tadcka_sitemap.provider.node.class">Tadcka\Bundle\SitemapBundle\Provider\NodeProvider</parameter>
        <parameter key="tadcka_sitemap.listener.tree_node.class">Tadcka\Bundle\SitemapBundle\EventListener\TreeNodeListener</parameter>
        <parameter key="tadcka_sitemap.security_manager.page.class">Tadcka\Bundle\SitemapBundle\Security\PageSecurityManager</parameter>
        <parameter key="tadcka_sitemap.provider.page.class">Tadcka\Bundle\SitemapBundle\Provider\PageProvider</parameter>
    </parameters>

    <services>

        <!--Tadcka tree loader-->
        <service id="tadcka_sitemap.loader.tree" class="%tadcka_sitemap.loader.tree.class%">
            <tag name="tadcka_tree" />
        </service>

        <!--Edit node event listener-->
        <service id="tadcka_sitemap.listener.edit_node" class="%tadcka_sitemap.listener.edit_node.class%">
            <tag name="kernel.event_listener" event="tadcka_sitemap.tab.edit_node" method="onEditNode" />
            <argument type="service" id="tadcka_sitemap.helper.router" />
        </service>

        <!--Sitemap node provider-->
        <service id="tadcka_sitemap.provider.node" class="%tadcka_sitemap.provider.node.class%">
            <argument type="service" id="tadcka_sitemap.manager.node_translation" />
        </service>

        <!--Tree node event listener-->
        <service id="tadcka_sitemap.listener.tree_node" class="%tadcka_sitemap.listener.tree_node.class%">
            <tag name="kernel.event_listener" event="tadcka_tree.node.create.success" method="onCreateNode" />
            <argument type="service" id="tadcka_sitemap.helper.router" />
            <argument type="service" id="tadcka_routing.manager.route" />
            <argument type="service" id="tadcka_sitemap.manager.node_translation" />
        </service>

        <!--Sitemap page security manager-->
        <service id="tadcka_sitemap.security_manager.page" class="%tadcka_sitemap.security_manager.page.class%">
            <argument type="service" id="security.context" />
        </service>

        <!--Sitemap page provider-->
        <service id="tadcka_sitemap.provider.page" class="%tadcka_sitemap.provider.page.class%">
            <argument type="service" id="tadcka_sitemap.provider.node" />
            <argument type="service" id="tadcka_sitemap.security_manager.page" />
        </service>

    </services>
</container>
